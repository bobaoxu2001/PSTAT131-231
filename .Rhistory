library(yardstick)
library(rlang)
library(corrplot)
library(discrim)
library(klaR)
library(pROC)
install.packages(pROC)
library(tidyverse)
library(tidymodels)
library(corrr)
library(poissonreg)
library(ISLR)
library(ISLR2)
library(ggplot2)
library(yardstick)
library(rlang)
library(corrplot)
library(discrim)
library(klaR)
#library(pROC)
library(knitr)
tidymodels_prefer()
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1202)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
train <- training(titanic_split)
test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
dim(titanic_train)
dim(titanic_test)
library(tidyverse)
library(tidymodels)
library(corrr)
library(poissonreg)
library(ISLR)
library(ISLR2)
library(ggplot2)
library(yardstick)
library(rlang)
library(corrplot)
library(discrim)
library(klaR)
library(pROC)
library(knitr)
tidymodels_prefer()
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
train <- training(titanic_split)
test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
dim(titanic_train)
dim(titanic_test)
train_folds <- vfold_cv(titanic_train, v = 10)
train_folds
log_reg = logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow = workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit = fit(log_wkflow, titanic_train)
lda_mod = discrim_linear() %>%
set_engine("MASS") %>%
set_mode("classification")
lda_wkflow = workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit = fit(lda_wkflow, titanic_train)
qda_mod = discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow = workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit = fit(qda_wkflow, titanic_train)
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
dim(titanic_train)
dim(titanic_test)
train_folds <- vfold_cv(titanic_train, v = 10)
train_folds
log_fit <- fit_resamples(log_wkflow,train_folds)
lda_fit <- fit_resamples(lda_wkflow,train_folds)
qda_fit <- fit_resamples(qda_wkflow,train_folds)
log_reg = logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_workflow = workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit = fit(log_workflow, titanic_train)
lda_mod = discrim_linear() %>%
set_engine("MASS") %>%
set_mode("classification")
lda_workflow = workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit = fit(lda_workflow, titanic_train)
qda_mod = discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_workflow = workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit = fit(qda_workflow, titanic_train)
log_fit <- fit_resamples(log_workflow,train_folds)
lda_fit <- fit_resamples(lda_workflow,train_folds)
qda_fit <- fit_resamples(qda_workflow,train_folds)
collect_metrics(log_fit)
collect_metrics(lda_fit)
collect_metrics(qda_fit)
log_fit_entire = fit(log_wkflow, titanic_train)
log_fit_entire
log_fit_entire = fit(log_workflow, titanic_train)
log_fit_entire
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
#titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
log_pred <- predict(log1_fit, new_data = titanic_test, type = "class")
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
train_acc <- augment(log1_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
train_acc <- augment(log_fit_entire, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
train_acc
test_acc <- augment(log_fit_entire, new_data = titanic_test) %>%
accuracy(truth = survived, estimate = .pred_class)
test_acc
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
train_accuracy <- augment(log_fit_entire, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
train_accuracy
test_accuracy <- augment(log_fit_entire, new_data = titanic_test) %>%
accuracy(truth = survived, estimate = .pred_class)
test_accuracy
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
test_accuracy <- augment(log_fit_entire, new_data = titanic_test) %>%
accuracy(truth = survived, estimate = .pred_class)
test_accuracy
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
train_accuracy <- augment(log_fit_entire, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
train_accuracy
test_accuracy <- augment(log_fit_entire, new_data = titanic_test) %>%
accuracy(truth = survived, estimate = .pred_class)
test_accuracy
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE)
library(tidyverse)
library(tidymodels)
library(corrr)
library(poissonreg)
library(ISLR)
library(ISLR2)
library(ggplot2)
library(yardstick)
library(rlang)
library(corrplot)
library(discrim)
library(klaR)
library(pROC)
library(knitr)
tidymodels_prefer()
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
dim(titanic_train)
dim(titanic_test)
train_folds <- vfold_cv(titanic_train, v = 10)
train_folds
log_reg = logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_workflow = workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit = fit(log_workflow, titanic_train)
lda_mod = discrim_linear() %>%
set_engine("MASS") %>%
set_mode("classification")
lda_workflow = workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit = fit(lda_workflow, titanic_train)
qda_mod = discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_workflow = workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit = fit(qda_workflow, titanic_train)
log_fit <- fit_resamples(log_workflow,train_folds)
lda_fit <- fit_resamples(lda_workflow,train_folds)
qda_fit <- fit_resamples(qda_workflow,train_folds)
collect_metrics(log_fit)
collect_metrics(lda_fit)
collect_metrics(qda_fit)
log_fit_entire = fit(log_workflow, titanic_train)
log_fit_entire
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
train_accuracy <- augment(log_fit_entire, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
train_accuracy
test_accuracy <- augment(log_fit_entire, new_data = titanic_test) %>%
accuracy(truth = survived, estimate = .pred_class)
test_accuracy
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(1588)
titanic_split <- initial_split(df, prop = 0.80, strata = survived)
titanic <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(1588)
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
titanic_training <- training(titanic_split)
titanic_testing <- testing(titanic_split)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
library(tidyverse)
library(tidymodels)
library(corrr)
library(poissonreg)
library(ggplot2)
library(yardstick)
library(rlang)
library(corrplot)
library(discrim)
library(klaR)
library(pROC)
library(knitr)
tidymodels_prefer()
titanic <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(1588)
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
titanic_training <- training(titanic_split)
titanic_testing <- testing(titanic_split)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(1588)
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
titanic_training <- training(titanic_split)
titanic_testing <- testing(titanic_split)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
summary(titanic_recipe)
df <- read.csv('/Users/wentaoyu/Documents/UCSB File/Stats/Pstat131/HWs/homework-3/data/titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
df <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(891) # keep the outcome stable
titanic_split <- initial_split(df, prop = 0.80, strata = survived) # split the data and stratified on survived
titanic_training <- training(titanic_split) # extract the training data
titanic_testing <- testing(titanic_split) # extract the testing data
titanic <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(1588)
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
titanic_training <- training(titanic_split)
titanic_testing <- testing(titanic_split)
titanic_split <- initial_split(titanic_data, prop = 0.80, strata = survived)
library(tidyverse)
library(tidymodels)
library(corrr)
library(poissonreg)
library(ggplot2)
library(yardstick)
library(rlang)
library(corrplot)
library(discrim)
library(klaR)
library(pROC)
tidymodels_prefer()
titanic <- read.csv('titanic.csv') %>%
mutate(survived = factor(survived,
levels = c("Yes", "No")),
pclass = factor(pclass))
set.seed(1588)
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
titanic_training <- training(titanic_split)
titanic_testing <- testing(titanic_split)
titanic_split <- initial_split(titanic, prop = 0.80, strata = survived)
dim(titanic_train)
dim(titanic_test)
train_folds <- vfold_cv(titanic_train, v = 10)
train_folds
log_reg = logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_workflow = workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit = fit(log_workflow, titanic_train)
lda_mod = discrim_linear() %>%
set_engine("MASS") %>%
set_mode("classification")
lda_workflow = workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit = fit(lda_workflow, titanic_train)
qda_mod = discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_workflow = workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit = fit(qda_workflow, titanic_train)
log_fit <- fit_resamples(log_workflow,train_folds)
lda_fit <- fit_resamples(lda_workflow,train_folds)
qda_fit <- fit_resamples(qda_workflow,train_folds)
collect_metrics(log_fit)
collect_metrics(lda_fit)
collect_metrics(qda_fit)
log_fit_entire = fit(log_workflow, titanic_train)
log_fit_entire
log_pred <- predict(log_fit_entire, new_data = titanic_test, type = "class")
bind_cols(log_pred,titanic_test$survived)
train_accuracy <- augment(log_fit_entire, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
train_accuracy
test_accuracy <- augment(log_fit_entire, new_data = titanic_test) %>%
accuracy(truth = survived, estimate = .pred_class)
test_accuracy
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
titanic = read.csv('titanic.csv')
titanic$pclass <- factor(titanic$pclass)
titanic$survived <- factor(titanic$survived, ordered=TRUE, levels=c('Yes','No'))
titanic_split <- initial_split(titanic, prop = 0.80,strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)
set.seed(1588)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
