qda_mod <- discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow <- workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wkflow, titanic_train)
nb_mod <- naive_Bayes() %>%
set_mode("classification") %>%
set_engine("klaR") %>%
set_args(usekernel = FALSE)
nb_wkflow <- workflow() %>%
add_model(nb_mod) %>%
add_recipe(titanic_recipe)
nb_fit <- fit(nb_wkflow, titanic_train)
nb_mod <- naive_Bayes() %>%
set_mode("classification") %>%
set_engine("klaR") %>%
set_args(usekernel = FALSE)
nb_wkflow <- workflow() %>%
add_model(nb_mod) %>%
add_recipe(titanic_recipe)
nb_fit <- fit(nb_wkflow, titanic_train)
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE)
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
log_reg_acc <- augment(log_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_reg_acc
lda_acc <- augment(lda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc
qda_acc <- augment(qda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
qda_acc
nb_acc <- augment(nb_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
nb_acc
accuracies <- c(log_reg_acc$.estimate, lda_acc$.estimate,
nb_acc$.estimate, qda_acc$.estimate)
models <- c("Logistic Regression", "LDA", "Naive Bayes", "QDA")
results <- tibble(accuracies = accuracies, models = models)
results %>%
arrange(-accuracies)
predict(log_fit, new_data = titanic_test, type = "prob")
augment(log_fit, new_data = titanic_test) %>%
conf_mat(truth = survived, estimate = .pred_class)
augment(log_fit, new_data = titanic_test) %>%
roc_curve(survived, .pred_Yes) %>%
autoplot()
augment(log_fit, new_data = titanic_test) %>%
roc_auc(survived,.pred_Yes)
predict(log_fit, new_data = titanic_test, type = "prob")
augment(log_fit, new_data = titanic_test) %>%
conf_mat(truth = survived, estimate = .pred_class)
augment(log_fit, new_data = titanic_test) %>%
roc_curve(survived, .pred_Yes) %>%
autoplot()
augment(log_fit, new_data = titanic_test) %>%
roc_auc(survived,.pred_Yes)
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
rplot(cor_titanic)
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
plot(cor_titanic)
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE)
titanic <- read.csv("titanic.csv")
head(titanic)
titanic$survived<-factor(titanic$survived, levels=c('Yes','No'))
titanic$pclass<-factor(titanic$pclass)
set.seed(1202)
titanic_split<-initial_split(titanic,prop=0.80,
strata = survived )
titanic_train<-training(titanic_split)
titanic_test<-testing(titanic_split)
titanic_train
titanic_test
ggplot(titanic_train,aes(x=survived))+geom_bar()
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
plot(cor_titanic)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
log_reg <- logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wkflow, titanic_train)
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE)
titanic <- read.csv("titanic.csv")
head(titanic)
titanic$survived<-factor(titanic$survived, levels=c('Yes','No'))
titanic$pclass<-factor(titanic$pclass)
set.seed(1202)
titanic_split<-initial_split(titanic,prop=0.80,
strata = survived )
library(ggplot2)
library(tidymodels)
library(ISLR)
library(ISLR2)
library(discrim)
library(poissonreg)
library(corrr)
library(klaR)
tidymodels_prefer()
set.seed(1202)
titanic_split<-initial_split(titanic,prop=0.80,
strata = survived )
titanic_train<-training(titanic_split)
titanic_test<-testing(titanic_split)
ggplot(titanic_train,aes(x=survived))+geom_bar()
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
rplot(cor_titanic)
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
plot(cor_titanic)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
log_reg <- logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wkflow, titanic_train)
lda_mod <- discrim_linear() %>%
set_mode("classification") %>%
set_engine("MASS")
lda_wkflow <- workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit <- fit(lda_wkflow, titanic_train)
qda_mod <- discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow <- workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wkflow, titanic_train)
qda_mod <- discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow <- workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wkflow, titanic_train)
nb_mod <- naive_Bayes() %>%
set_mode("classification") %>%
set_engine("klaR") %>%
set_args(usekernel = FALSE)
nb_wkflow <- workflow() %>%
add_model(nb_mod) %>%
add_recipe(titanic_recipe)
nb_fit <- fit(nb_wkflow, titanic_train)
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
log_reg_acc <- augment(log_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_reg_acc
lda_acc <- augment(lda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc
qda_acc <- augment(qda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
qda_acc
nb_acc <- augment(nb_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
nb_acc
accuracies <- c(log_reg_acc$.estimate, lda_acc$.estimate,
nb_acc$.estimate, qda_acc$.estimate)
models <- c("Logistic Regression", "LDA", "Naive Bayes", "QDA")
results <- tibble(accuracies = accuracies, models = models)
results %>%
arrange(-accuracies)
predict(log_fit, new_data = titanic_test, type = "prob")
augment(log_fit, new_data = titanic_test) %>%
conf_mat(truth = survived, estimate = .pred_class)
augment(log_fit, new_data = titanic_test) %>%
roc_curve(survived, .pred_Yes) %>%
autoplot()
augment(log_fit, new_data = titanic_test) %>%
roc_auc(survived,.pred_Yes)
log_acc <- predict(log_fit, new_data = titanic_training, type = 'class') %>%
bind_cols(titanic_training %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)  accuracy(truth = survived, estimate = .pred_class)
log_reg <- logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wkflow, titanic_train)
lda_mod <- discrim_linear() %>%
set_mode("classification") %>%
set_engine("MASS")
lda_wkflow <- workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit <- fit(lda_wkflow, titanic_train)
qda_mod <- discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow <- workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wkflow, titanic_train)
nb_mod <- naive_Bayes() %>%
set_mode("classification") %>%
set_engine("klaR") %>%
set_args(usekernel = FALSE)
nb_wkflow <- workflow() %>%
add_model(nb_mod) %>%
add_recipe(titanic_recipe)
nb_fit <- fit(nb_wkflow, titanic_train)
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
log_reg_acc <- augment(log_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_reg_acc
set.seed(1888)
titanic_split<-initial_split(titanic,prop=0.80,
strata = survived )
titanic_train<-training(titanic_split)
titanic_test<-testing(titanic_split)
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE)
library(ggplot2)
library(tidymodels)
library(ISLR)
library(ISLR2)
library(discrim)
library(poissonreg)
library(corrr)
library(klaR)
tidymodels_prefer()
titanic <- read.csv("titanic.csv")
head(titanic)
titanic$survived<-factor(titanic$survived, levels=c('Yes','No'))
titanic$pclass<-factor(titanic$pclass)
set.seed(1888)
titanic_split<-initial_split(titanic,prop=0.80,
strata = survived )
titanic_train<-training(titanic_split)
titanic_test<-testing(titanic_split)
ggplot(titanic_train,aes(x=survived))+geom_bar()
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
plot(cor_titanic)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
log_reg <- logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wkflow, titanic_train)
lda_mod <- discrim_linear() %>%
set_mode("classification") %>%
set_engine("MASS")
lda_wkflow <- workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit <- fit(lda_wkflow, titanic_train)
qda_mod <- discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow <- workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wkflow, titanic_train)
nb_mod <- naive_Bayes() %>%
set_mode("classification") %>%
set_engine("klaR") %>%
set_args(usekernel = FALSE)
nb_wkflow <- workflow() %>%
add_model(nb_mod) %>%
add_recipe(titanic_recipe)
nb_fit <- fit(nb_wkflow, titanic_train)
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
log_reg_acc <- augment(log_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_reg_acc
lda_acc <- augment(lda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc
qda_acc <- augment(qda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
qda_acc
nb_acc <- augment(nb_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
nb_acc
accuracies <- c(log_reg_acc$.estimate, lda_acc$.estimate,
nb_acc$.estimate, qda_acc$.estimate)
models <- c("Logistic Regression", "LDA", "Naive Bayes", "QDA")
results <- tibble(accuracies = accuracies, models = models)
results %>%
arrange(-accuracies)
predict(log_fit, new_data = titanic_test, type = "prob")
augment(log_fit, new_data = titanic_test) %>%
conf_mat(truth = survived, estimate = .pred_class)
augment(log_fit, new_data = titanic_test) %>%
roc_curve(survived, .pred_Yes) %>%
autoplot()
augment(log_fit, new_data = titanic_test) %>%
roc_auc(survived,.pred_Yes)
cor_titanic <- titanic_train %>%
select(is.numeric) %>%
correlate()
rplot(cor_titanic)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
log_reg <- logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wkflow, titanic_train)
titanic_recipe <- recipe(survived ~ pclass + sex + age + sib_sp +
parch + fare, data = titanic_train) %>%
step_impute_linear(age) %>%
step_dummy(all_nominal_predictors()) %>%
step_interact(terms= ~ starts_with("sex"):fare+
age:fare)
titanic_recipe
summary(titanic_recipe)
log_reg <- logistic_reg() %>%
set_engine("glm") %>%
set_mode("classification")
log_wkflow <- workflow() %>%
add_model(log_reg) %>%
add_recipe(titanic_recipe)
log_fit <- fit(log_wkflow, titanic_train)
lda_mod <- discrim_linear() %>%
set_mode("classification") %>%
set_engine("MASS")
lda_wkflow <- workflow() %>%
add_model(lda_mod) %>%
add_recipe(titanic_recipe)
lda_fit <- fit(lda_wkflow, titanic_train)
qda_mod <- discrim_quad() %>%
set_mode("classification") %>%
set_engine("MASS")
qda_wkflow <- workflow() %>%
add_model(qda_mod) %>%
add_recipe(titanic_recipe)
qda_fit <- fit(qda_wkflow, titanic_train)
nb_mod <- naive_Bayes() %>%
set_mode("classification") %>%
set_engine("klaR") %>%
set_args(usekernel = FALSE)
nb_wkflow <- workflow() %>%
add_model(nb_mod) %>%
add_recipe(titanic_recipe)
nb_fit <- fit(nb_wkflow, titanic_train)
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
log_reg_acc <- augment(log_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_reg_acc
bind_titanic_train=bind_cols(predict(log_fit,new_data=titanic_train,type="class"),
predict(lda_fit,new_data=titanic_train,type="class"),
predict(qda_fit,new_data=titanic_train,type="class"),
predict(nb_fit,new_data=titanic_train,type="class"),
titanic_train$survived)
log_reg_acc <- augment(log_fit, new_data = bind_titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc <- predict(log_fit, new_data = titanic_training, type = 'class') %>%
bind_cols(titanic_training %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc <- predict(log_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_training %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc <- predict(log_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_train %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc <- augment(lda_fit, new_data = titanic_train) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc
log_acc <- predict(log_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_train %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc <- predict(log_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_train %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
log_acc
lda_acc <- predict(lda_fit, new_data = titanic_training, type = 'class') %>%
bind_cols(titanic_training %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc <- predict(lda_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_train %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
lda_acc
qda_acc <- predict(qda_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_traini %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
qda_acc <- predict(qda_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_train %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
qda_acc
nb_acc <- predict(nb_fit, new_data = titanic_training, type = 'class') %>%
bind_cols(titanic_training %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
nb_acc <- predict(nb_fit, new_data = titanic_train, type = 'class') %>%
bind_cols(titanic_train %>% select(survived)) %>%
accuracy(truth = survived, estimate = .pred_class)
nb_acc
accuracies <- c(log_reg_acc$.estimate, lda_acc$.estimate,
nb_acc$.estimate, qda_acc$.estimate)
models <- c("Logistic Regression", "LDA", "Naive Bayes", "QDA")
results <- tibble(accuracies = accuracies, models = models)
results %>%
arrange(-accuracies)
augment(log_fit, new_data = titanic_train) %>%
conf_mat(truth = Direction, estimate = .pred_class) %>%
autoplot(type = "heatmap")
augment(log_fit, new_data = titanic_train) %>%
conf_mat(truth = survived, estimate = .pred_class) %>%
autoplot(type = "heatmap")
predict(log_fit, new_data = titanic_test, type = "prob")
multi_metric <- metric_set(accuracy, sensitivity, specificity)
augment(log_fit, new_data = titanic_test) %>%
multi_metric(truth = survived, estimate = .pred_class)
multi_metric <- metric_set(accuracy, sensitivity, specificity)
augment(log_fit, new_data = titanic_test) %>%
multi_metric(truth = survived, estimate = .pred_class)
augment(log_fit, new_data = titanic_train) %>%
conf_mat(truth = survived, estimate = .pred_class) %>%
autoplot(type = "heatmap")
augment(log_fit, new_data = titanic_test) %>%
roc_curve(survived, .pred_Yes) %>%
autoplot()
log_result %>%
roc_auc(survived, .pred_Yes)
augment(log_fit, new_data = titanic_test) %>%
roc_auc(survived,.pred_Yes)
predict(log_fit, new_data = titanic_test, type = "prob")
2accuracies <- c(log_reg_acc$.estimate, lda_acc$.estimate,
accuracies <- c(log_reg_acc$.estimate, lda_acc$.estimate,
nb_acc$.estimate, qda_acc$.estimate)
models <- c("Logistic Regression", "LDA", "Naive Bayes", "QDA")
results <- tibble(accuracies = accuracies, models = models)
results %>%
arrange(-accuracies)
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
warning = FALSE)
library(ggplot2)
library(tidymodels)
library(ISLR)
library(ISLR2)
library(discrim)
library(poissonreg)
library(corrr)
library(klaR)
tidymodels_prefer()
titanic <- read.csv("titanic.csv")
head(titanic)
